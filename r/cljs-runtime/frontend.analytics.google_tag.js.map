{"version":3,"sources":["frontend/analytics/google_tag.cljc"],"mappings":";AASA,4CAAA,5CAAMA,gGAAaC;AAAnB,AAAA,0FAAA,0DAAA,2CAAA,uDAAA,KAAA,qDAAA,kBAAA,oDAGiB,CAAA,2FAAoDA;;AAErE,0CAAA,1CAAMC,4FAAWD;AAAjB,AAAA,0FAAA,mDAEG,CAAA,kHAAA,JAAuEA;;AAE1E,+CAAA,/CAAME,sGACHC;AADH,AAEE,IAAAC,aAA2BD;IAA3BC,iBAAA,AAAAC,4BAAAD;cAAA,AAAAE,4CAAAF,eAAA,rEAAcG;SAAd,AAAAD,4CAAAF,eAAA,hEAAsBJ;AAAtB,AACE,oBAAI,iBAAAQ,oBAAKD;AAAL,AAAA,oBAAAC;AAAaR;;AAAbQ;;;AACF,AAAI,AAAAC,0DAAAC,mCAAA,wDAAA,gCAAA,KAAA,GAAA,8CAAA,qDAAA,KAAAC,gBAAA;AAAA,AAAA,0FAAA,6CAAoDX;GAApD,OAAA,KAAA,MAAA;;AACA,OAACD,0CAAYC;;AAEjB,AACE,AAAAS,0DAAAC,mCAAA,wDAAA,gCAAA,KAAA,GAAA,8CAAA,qDAAA,KAAAC,gBAAA;AAAA,AAAA,0FAAA;GAAA,OAAA,KAAA,MAAA;;AADF,0FAAA,mDAAA,2CAAA,wDAAA;;;AAIN,kDAAA,lDAAMC,4GAAmBT;AAAzB,AACE,IAAAU,aAA2BV;IAA3BU,iBAAA,AAAAR,4BAAAQ;cAAA,AAAAP,4CAAAO,eAAA,rEAAcN;SAAd,AAAAD,4CAAAO,eAAA,hEAAsBb;AAAtB,AACE,oBAAI,iBAAAQ,oBAAKD;AAAL,AAAA,oBAAAC;AAAaR;;AAAbQ;;;AAAJ,0FAAA,0DAEG,CAAA,gNAAA,JAGoBR;;AALvB,0FAAA,mDAAA,2CAAA,wDAAA;;;AAWD,2CAAA,3CAAMc,8FAAYC,OAAOC;AAAzB,AACE,IAAMC,SAAO,AAACC,qBAAQF;AAAtB,AACE,AAAAP,0DAAAC,mCAAA,qDAAA,gCAAA,KAAA,GAAA,8CAAA,qDAAA,KAAAC,gBAAA;AAAA,AAAA,0FAAA,WAAiBI,OAAOC;GAAxB,OAAA,KAAA,MAAA;;AACA,YAAA,LAACG,aAAgBJ,OAAOE","names":["frontend.analytics.google-tag/script-cljs","id","frontend.analytics.google-tag/script-js","frontend.analytics.google-tag/script-tag-src","google-analytics-config","map__44895","cljs.core/--destructure-map","cljs.core.get","enabled","and__5043__auto__","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","frontend.analytics.google-tag/script-tag-config","map__44924","frontend.analytics.google-tag/send-event","action","data","datajs","cljs.core/clj->js","js/gtag"],"sourcesContent":["(ns frontend.analytics.google-tag\n  (:require\n   #?(:clj  [taoensso.timbre :refer [debug info warn error]])\n   #?(:cljs  [taoensso.timbre :refer-macros [debug info warn error]])))\n\n;The syntax is :async true for tags that don't have a value, but you'll need to ensure that the :mode is set to :html. So:\n; (html {:mode :html} [:script {:async true}])\n; Note that if you use the html5 macro, the mode will automatically be set when rendering.\n\n(defn script-cljs [id]\n  [:script {:async true ; async not rendered. see: https://github.com/weavejester/hiccup/issues/182\n            :type \"text/javascript\"\n            :src (str \"https://www.googletagmanager.com/gtag/js?id=\" id)}])\n\n(defn script-js [id]\n  [:div\n   (str \"<script async src='https://www.googletagmanager.com/gtag/js?id=\" id \"' type= 'text/javascript'> </script>\")])\n\n(defn script-tag-src\n  [google-analytics-config]\n  (let [{:keys [enabled id]} google-analytics-config]\n    (if (and enabled id)\n      (do (debug \"google analytics starting with google id: \" id)\n          (script-cljs id)\n          #_(script-js id))\n      (do\n        (debug \"no google analytics config!\")\n        [:div {:class \"no-google-analytics-config-tag\"}]))))\n\n(defn script-tag-config [google-analytics-config]\n  (let [{:keys [enabled id]} google-analytics-config]\n    (if (and enabled id)\n      [:script\n       (str \"window.dataLayer = window.dataLayer || [];\n         function gtag(){dataLayer.push(arguments);}\n         gtag('js', new Date());\n         gtag('config', '\" id \"', {cookie_flags: 'SameSite=None;Secure' }  );\") ; https://stackoverflow.com/questions/62569419/how-to-set-secure-attribute-of-the-cookies-used-by-google-analytics-global-sit\n       ]\n      [:div {:class \"no-google-analytics-config-config\"}])))\n\n#?(:cljs\n   ; gtag(\"event\", \"sign_up\", {\"method\": \"email\" });\n   (defn send-event [action data]\n     (let [datajs (clj->js data)]\n       (info \"ga event\" action data)\n       (js/gtag \"event\" action datajs))))\n\n"],"x_google_ignoreList":[0]}