{"version":3,"sources":["goldly/static.cljs"],"mappings":"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","names":["goldly.static/static?","pref","profile","static?","cljs.core._EQ_","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","var_args","args__5775__auto__","len__5769__auto__","i__5770__auto__","argseq__5776__auto__","cljs.core/IndexedSeq","goldly.static/error-handler","seq55081","self__5755__auto__","cljs.core/seq","args","goldly.static/make-url","ext","asset-path","goldly.static/get-url","uri","ch","cljs.core.async.chan","handler","data","d","cljs.reader.read_string","cljs.core.async.put_BANG_","ajax.core.GET","goldly.static/cljs-explore","url","goldly.static/extensions","goldly.static/get-ext-static","ext-name","c__41381__auto__","cljs.core.async.impl.dispatch/run","f__41382__auto__","switch__41305__auto__","state_55114","state_val_55115","inst_55092","inst_55094","statearr-55116","cljs.core.async.impl.ioc-helpers/take!","inst_55096","inst_55097","inst_55098","inst_55099","inst_55100","p1__55087#","inst_55101","inst_55106","inst_55107","inst_55108","statearr-55117","cljs.core.async.impl.ioc-helpers/put!","inst_55110","cljs.core.async.impl.ioc-helpers/return-chan","statearr-55118","state-machine__41306__auto__","ret-value__41307__auto__","result__41308__auto__","cljs.core/keyword-identical?","ex__41309__auto__","e55119","statearr-55120","statearr-55121","cljs.core/first","state__41383__auto__","statearr-55122","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","_","e","cljs.core.filter","goldly.static/get-code","filename"],"sourcesContent":["(ns goldly.static\n  (:require\n   [taoensso.timbre :refer-macros [debug info infof error]]\n   [ajax.core :refer [GET]]\n   [cljs.core.async :refer [>! <! chan close! put! timeout] :refer-macros [go]]\n   [cljs.reader :refer [read-string]]\n   [webly.build.prefs :refer [pref]]))\n\n(defn static? []\n  (let [pref (pref)\n        profile (:profile pref)\n        static? (= \"static\" profile)]\n    (info \"pref:\" pref)\n    (info \"static?: \" static?)\n    static?))\n\n(defn error-handler [& args]\n  (error \"error getting data ...\"))\n\n(defn make-url [ext]\n  (let [pref (pref)\n        asset-path (:asset-path pref)]\n    (str asset-path \"/\" ext)))\n\n(defn get-url [uri]\n  (let [ch (chan)\n        handler (fn [data]\n                  (infof \"static/get  %s\" uri)\n                  (let [d (read-string data)]\n                    (info \"data: \" d)\n                    (put! ch {:result d})))]\n    (GET uri {:handler handler\n              :error-handler error-handler})\n    ch))\n\n(defn cljs-explore []\n  (let [url (make-url \"sci-cljs-autoload.edn\")]\n    (get-url url)))\n\n(defn extensions []\n  (let [url (make-url \"extensions.edn\")]\n    (get-url url)))\n\n(defn get-ext-static [ext-name]\n  (go (let [ch (chan)\n            data (<! (extensions))\n            _ (info \"data: \" data)\n            e (filter #(= ext-name (:name %)) data)]\n        (info \"ext: \" e)\n        (>! ch e))))\n\n(defn get-code [filename]\n  (let [uri (make-url filename)\n        ch (chan)\n        handler (fn [data]\n                  (infof \"static/get-code received code for: %s\" filename)\n                  (let [d {:code data\n                           :filename filename}]\n                    ;(info \"code: \" d)\n                    (put! ch {:result d})))]\n    (info \"getcode url: \" uri)\n    (GET uri {:handler handler\n              :error-handler error-handler})\n    ch))\n\n"]}