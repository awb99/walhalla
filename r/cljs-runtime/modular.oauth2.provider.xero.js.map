{"version":3,"sources":["modular/oauth2/provider/xero.cljc"],"mappings":";AAIA,wDAAA,gEAAAA,xHAAMI;AAAN,AAAA,IAAAH,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;YAAA,AAAAE,4CAAAF,eAAA,nEAAwCI;AAAxC,AAAA,kDAAA,mJAAA,5FACU,AAAA,qFAAQA,4DACT,AAAA,mFAAOA;;AAIhB,uDAAA,vDAAMC,sHAAyBC;AAA/B,AAAA,kDAAA,gBACmB,CAAA,sDAAeA;;AAElC,0CAAA,1CAAMC,4FAAYC;AAAlB,AAAA,kDAAA,kUAAA,uDAAA,pUACS,oDAAA,mFAAA,wEAAA,/MAACC,+CAAOD;;AAGjB,sCAAA,wCAAA,kEAAA,6DAAA,4FAAA,uEAAA,8DAAA,kEAAA,qDAAA,wFAAA,gJAAA,gGAAA,oDAAA,2CAAA,4DAAA,gGAAA,gDAAA,WAAA,2CAAA,uEAAA,OAAA,8DAAA,11CAAKE,uzBAMwBP,/FAKbE,wWAIDE;AAEf,AAAAI,oFAAA,sDAAA,WAAkCC;AAAlC,AACEF;;AA2BF,kDAAA,lDAAMG,4GAAoBC;AAA1B,AAAA,kDAAA,iBACoBA","names":["p__39851","map__39852","cljs.core/--destructure-map","cljs.core.get","modular.oauth2.provider.xero/parse-authorize-response","query","modular.oauth2.provider.xero/api-request-auth-header","token","modular.oauth2.provider.xero/user-parse","data","cljs.core.get_in","modular.oauth2.provider.xero/config","modular.oauth2.protocol/provider-config","_","modular.oauth2.provider.xero/header-xero-tenant","tenant-id"],"sourcesContent":["(ns modular.oauth2.provider.xero\n  (:require\n   [modular.oauth2.protocol :refer [provider-config]]))\n\n(defn parse-authorize-response [{:keys [query]}] ;anchor\n  {:scope (:scope query)\n   :code (:code query)})\n\n;; api requests\n\n(defn api-request-auth-header [token]\n  {\"Authorization\" (str \"Bearer \" token)})\n\n(defn user-parse [data]\n  {:user (get-in data [:Organisations :Name])\n   :email \"no email\"})\n\n(def config\n  {; authorize\n   :authorize-uri \"https://login.xero.com/identity/connect/authorize\"\n   :authorize-query-params {:response_type \"code\"\n                            :returnUrl \"https://login.xero.com/identity/identity/connect/authorize\" ; not sure why this is needed.    \n                            }\n   :parse-authorize-response parse-authorize-response\n   ; refresh token  \n   :token-uri \"https://identity.xero.com/connect/token\"\n   :accessTokenResponseKey \"id_token\"\n   ; api requests\n   :auth-header api-request-auth-header\n   :endpoints {:userinfo \"https://api.xero.com/api.xro/2.0/Organisation\"}\n   ; userinfo\n   :user \"https://api.xero.com/api.xro/2.0/Organisation\"\n   :user-parse user-parse})\n\n(defmethod provider-config :xero [_]\n  config)\n\n;; Xero example for authorize request\n\n; https://login.xero.com/identity/connect/authorize\n; ?response_type=code\n; &client_id=YOURCLIENTID\n; &redirect_uri=YOURREDIRECTURI\n; &scope=openid profile email accounting.transactions\n; &state=123\n\n; https://github.com/XeroAPI/Xero-OpenAPI\n\n; https://xeroapi.github.io/xero-node/accounting/index.html\n; https://github.com/XeroAPI/xero-node/blob/master/src/gen/api/accountingApi.ts\n\n; var paginate = require(\"../paginate/paginate.js\").paginate;\n\n   ; https://xeroapi.github.io/xero-node/accounting/index.html#api-Accounting-getInvoice\n\n   ; /Invoices/{InvoiceID}\n\n; https://api-explorer.xero.com/\n\n;; postman url:\n;; https://app.getpostman.com/run-collection/d069793e904f7602770d#?env%5BOAuth%202.0%5D=W3sia2V5IjoiY2xpZW50X2lkIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6ImNsaWVudF9zZWNyZXQiLCJ2YWx1ZSI6IiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoicmVmcmVzaF90b2tlbiIsInZhbHVlIjoiIiwiZW5hYmxlZCI6dHJ1ZX0seyJrZXkiOiJhY2Nlc3NfdG9rZW4iLCJ2YWx1ZSI6IiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoieGVyby10ZW5hbnQtaWQiLCJ2YWx1ZSI6IiIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoicmVfZGlyZWN0VVJJIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6InNjb3BlcyIsInZhbHVlIjoiIiwiZW5hYmxlZCI6dHJ1ZX0seyJrZXkiOiJzdGF0ZSIsInZhbHVlIjoiIiwiZW5hYmxlZCI6dHJ1ZX1d\n\n(defn header-xero-tenant [tenant-id]\n  {\"Xero-Tenant-Id\" tenant-id})\n\n; request success:\n;  \"Status\": \"OK\""],"x_google_ignoreList":[0]}